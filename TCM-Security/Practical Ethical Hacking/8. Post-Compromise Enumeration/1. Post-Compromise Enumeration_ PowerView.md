# Post-Compromise Enumeration: PowerView

# PowerView

From Github, download PowerSploit/PowerView.ps1

We need to copy that file to one of the Windows machines, to enumerate stuff 


On Windows CMD:
```
C:\Users\fcastle\Downloads> powershell -ep bypass
```

Can alternatively do:
```
C:\Users\fcastle\Downloads> powershell -ExecutionPolicy bypass
```

It basically enables us to run scripts (i.e. instead of accidentally running stuff)

Call our program:
```
PS C:\Users\fcastle\Downloads> . .\PowerView.ps1
```
![pc-enum-1](https://user-images.githubusercontent.com/87711310/209447181-8318fe65-7191-4df2-a212-b8f60aa0c52b.png)

Follow up commands we can now run:
```
PS C:\Users\fcastle\Downloads> Get-NetDomain
PS C:\Users\fcastle\Downloads> Get-NetDomainController
PS C:\Users\fcastle\Downloads> Get-DomainPolicy
PS C:\Users\fcastle\Downloads> (Get-DomainPolicy)."SystemAccess"
PS C:\Users\fcastle\Downloads> Get-NetUser
PS C:\Users\fcastle\Downloads> Get-NetUser | select cn
PS C:\Users\fcastle\Downloads> Get-NetUser | select description
```

![pc-enum-2](https://user-images.githubusercontent.com/87711310/209447182-0b9f86ac-0ef8-436d-9ebc-966322c953f2.png)
![pc-enum-3](https://user-images.githubusercontent.com/87711310/209447184-fe2f8cee-af04-4095-8989-b66d3fbdcbff.png)

Can select and 'grep' through different attributes

![pc-enum-4](https://user-images.githubusercontent.com/87711310/209447185-b154b9b4-cc98-4681-9892-39b5bb1475cd.png)

```
PS C:\Users\fcastle\Downloads> Get-DomainUser -Properties logoncount
PS C:\Users\fcastle\Downloads> Get-DomainUser -Properties badpwdcount
PS C:\Users\fcastle\Downloads> Get-NetComputer
PS C:\Users\fcastle\Downloads> Get-NetComputer | select OperatingSystem
PS C:\Users\fcastle\Downloads> Get-NetGroup
PS C:\Users\fcastle\Downloads> Get-NetGroupMember
```
![pc-enum-5](https://user-images.githubusercontent.com/87711310/209447186-a3b2fa33-2edd-4afa-972b-41ce5ca0b51b.png)

![pc-enum-6](https://user-images.githubusercontent.com/87711310/209447177-e2dcccb0-7f62-49fc-8bcb-647d4412ca1e.png)


Other functionality
```
PS C:\Users\fcastle\Downloads> Invoke-ShareFinder
PS C:\Users\fcastle\Downloads> Get-NetGPO
```
GPO == group policies
```
PS C:\Users\fcastle\Downloads> Get-NetGPO | select displayname, whenchanged
```
![pc-enum-7](https://user-images.githubusercontent.com/87711310/209447179-f75478d7-d9d1-412f-9aab-f1b14d49cf34.png)

![pc-enum-8](https://user-images.githubusercontent.com/87711310/209447180-814819ae-d997-4303-a580-753f7ce793cc.png)


